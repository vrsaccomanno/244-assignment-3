---
title: "Assignment 3"
author: "Vienna Saccomanno"
date: "2/26/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Task 2: Truckee River Flow (2000-2016)

```{r packages, warning=FALSE, message=FALSE}
#Attached packages
library(tidyverse)
library(tseries)
library(forecast)
library(tmap)
library(sf)
library(leaflet)
library(ggrepel)
library(RColorBrewer)
```

```{r data, warning=FALSE, message=FALSE}
#Load data
truckee<- read_csv("truckee_flow.csv")

#Convert data to time series data
truckee_ts<- ts(truckee$mean_va, frequency = 12, start = c(2000,1)) #Start in January, 2000
#truckee_ts
plot(truckee_ts)

#Decompse the time series
truckee_dc<-decompose(truckee_ts)
plot(truckee_dc)
```

###Task 2a. Description of the decomposed graphs
- The decomposed data show stationary, additive time series data with clear seasonality within each year.
- The overall trend seems to be decreasing over time, with no perceptible outliers in this dataset.
- There might be a longer (~5 year) trend beyond the normal seasonality, but it not easily discernable. 
- Based on the scale, residuals might be a big contributor (i.e. there is a lot of noise beyond seasonality)



###Task 2b. Forecasting for 5 years - exponential smoothing (Holt-Winters)
```{r forecast, warning=FALSE, message=FALSE}

truckee_hw<-HoltWinters(truckee_ts)
#truckee_hw

#Smoothing parameters:
 #alpha: 0.2418713
 #beta : 0
 #gamma: 0.3384547

plot(truckee_hw) #Original data with the predication on top to check model accuracy (not yet forecasting)

#Future forecasting with holtwinters

truckee_forecast<- forecast(truckee_hw, h=60) #forecasting for 5 years, 60 months
plot(truckee_forecast, xlab = "Year", ylab = "Mean Discharge Value", sub = "Exponential smoothing of predictions about the Truckee River's future discharge. Data:USGS")

#Check the distribution of residuals
hist(truckee_forecast$residuals) #look pretty normal
```

##Task 3: Mapping California's National Parks
```{r}
#read in park data
nps<- read_sf(".", layer="nps_boundary") %>% 
  st_transform(crs=4326)

plot(np)
#Read in CA county data
ca_counties<- read_sf(".", layer= "california_county_shape_file")
st_crs(ca_counties)=4326

```

